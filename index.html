<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marseille Loc - Location Premium</title>
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        black: '#050505',
                        card: '#111111',
                        gold: {
                            400: '#D4AF37',
                            500: '#C5A028',
                            glow: 'rgba(212, 175, 55, 0.5)'
                        }
                    },
                    fontFamily: {
                        sans: ['Segoe UI', 'Helvetica', 'Arial', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>

    <script src="https://unpkg.com/lucide@latest"></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
       (function(){
          emailjs.init("REvWVsIQre7DcVdhq");
       })();
    </script>

    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <style>
        body {
            background-color: #050505;
            color: white;
            overflow-x: hidden;
        }

        .bg-logo-watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%; 
            opacity: 0.15;
            pointer-events: none;
            z-index: 0;
            animation: pulse 8s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.12; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.18; transform: translate(-50%, -50%) scale(1.03); }
            100% { opacity: 0.12; transform: translate(-50%, -50%) scale(1); }
        }

        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }

        /* Flatpickr input style */
        #booking-dates {
            width: 100%;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05);
            color: white;
        }
    </style>
</head>
<body class="antialiased">

<img src="logo-marseille.png.png" alt="" class="bg-logo-watermark">

<header class="fixed top-0 w-full z-50 transition-all duration-300 py-4 glass bg-black/80">
    <div class="container mx-auto px-6 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <img src="logo-marseille.png.png" alt="Marseille Loc" class="h-12 w-auto object-contain">
        </div>

        <div class="flex items-center gap-4">
            <a href="https://wa.me/33758066416" target="_blank" class="hidden md:flex items-center gap-2 px-4 py-2 rounded-full border border-white/10 hover:border-gold-400/50 transition-colors text-sm">
                <i data-lucide="message-square" class="w-4 h-4 text-gold-400"></i>
                <span>Contacter WhatsApp</span>
            </a>
            <button onclick="scrollToCars()" class="bg-gold-400 hover:bg-gold-500 text-black font-bold py-2 px-6 rounded-full shadow-[0_0_15px_rgba(212,175,55,0.4)] transition-transform hover:scale-105">
                Réserver
            </button>
        </div>
    </div>
</header>

<section class="relative pt-40 pb-20 px-6 overflow-hidden">
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-gold-400/10 blur-[100px] rounded-full pointer-events-none z-0"></div>

    <div class="container mx-auto text-center relative z-10">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-gold-400/30 bg-gold-400/10 text-gold-400 text-xs font-bold tracking-wider mb-6">
            <i data-lucide="star" class="w-3 h-3"></i> PREMIUM CAR RENTAL MARSEILLE
        </div>

        <h1 class="text-5xl md:text-7xl font-extrabold tracking-tight mb-6 leading-tight">
            L'Élégance de la <br/>
            <span class="text-transparent bg-clip-text bg-gradient-to-r from-gold-400 via-yellow-200 to-gold-400">
                Conduite.
            </span>
        </h1>

        <p class="mt-4 text-lg text-gray-400 max-w-2xl mx-auto mb-10 font-light">
            Découvrez Marseille au volant de véhicules d'exception. <br>
            Service VIP et tarifs transparents.
        </p>

        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
            <button onclick="scrollToCars()" class="w-full sm:w-auto px-8 py-4 bg-gold-400 hover:bg-gold-500 text-black font-bold rounded-full flex items-center justify-center gap-2">
                Voir les véhicules <i data-lucide="chevron-right" class="w-5 h-5"></i>
            </button>
        </div>
    </div>
</section>

<section id="cars-section" class="py-20 bg-[#0a0a0a]">
    <div class="container mx-auto px-6">
        <div class="mb-12 text-center md:text-left">
            <h2 class="text-3xl md:text-4xl font-bold mb-2">Notre Flotte <span class="text-gold-400">Exclusive</span></h2>
            <p class="text-gray-400">Sélectionnée pour le confort et la performance.</p>
        </div>

        <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3" id="cars-grid"></div>
    </div>
</section>

<section class="py-20 border-t border-white/10 text-center px-6">
    <h2 class="text-3xl font-bold mb-6">Prêt à prendre la route ?</h2>
    <a href="https://wa.me/33758066416" target="_blank" class="inline-flex items-center justify-center gap-2 bg-gold-400 text-black hover:bg-white px-8 py-4 rounded-full text-lg font-bold transition-colors">
        <i data-lucide="message-square" class="w-5 h-5"></i> Contacter par WhatsApp
    </a>
    <p class="mt-8 text-sm text-gray-600">© 2024 Marseille Loc. Tous droits réservés.</p>
</section>

<div id="booking-modal" class="fixed inset-0 z-[100] hidden">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>

    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-md p-0">
        <div class="relative bg-[#111] border border-gold-400/30 rounded-2xl shadow-[0_0_50px_rgba(212,175,55,0.15)] overflow-hidden">
            
            <div class="px-6 py-4 border-b border-white/10 flex justify-between items-center bg-white/5">
                <div>
                    <h3 class="text-lg font-bold text-white">Demande de Réservation</h3>
                    <p class="text-[10px] text-gold-400 uppercase tracking-wider">Service Conciergerie</p>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-white transition-colors">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>

            <form id="booking-form" onsubmit="submitBooking(event)" class="p-6 space-y-4">
                
                <div class="flex items-center gap-4 bg-black/50 p-3 rounded-lg border border-white/5 mb-4">
                    <img id="modal-car-img" src="" class="w-20 h-14 object-cover rounded-md border border-white/10" alt="">
                    <div>
                        <h4 id="modal-car-name" class="font-bold text-white">Voiture</h4>
                        <span id="modal-car-price" class="text-sm text-gold-400 font-bold">0€ / jour</span>
                    </div>
                </div>

                <!-- Champ Flatpickr Range -->
                <div class="space-y-1">
                    <label class="text-[10px] text-gray-500 uppercase tracking-wider font-bold">Vos dates</label>
                    <input type="text" id="booking-dates" placeholder="Sélectionnez vos dates" required>
                </div>

                <div class="space-y-1">
                    <label class="text-[10px] text-gray-500 uppercase tracking-wider font-bold">Nom Complet</label>
                    <div class="relative">
                        <i data-lucide="user" class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"></i>
                        <input type="text" id="booking-name" required placeholder="Votre nom" class="w-full bg-white/5 border border-white/10 rounded-lg pl-10 pr-4 py-2 text-sm text-white focus:border-gold-400 focus:outline-none transition-colors">
                    </div>
                </div>

                <div class="space-y-1">
                    <label class="text-[10px] text-gray-500 uppercase tracking-wider font-bold">Téléphone</label>
                    <div class="relative">
                        <i data-lucide="phone" class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"></i>
                        <input type="tel" id="booking-phone" required placeholder="06 12 34 56 78" class="w-full bg-white/5 border border-white/10 rounded-lg pl-10 pr-4 py-2 text-sm text-white focus:border-gold-400 focus:outline-none transition-colors">
                    </div>
                </div>

                <button type="submit" class="w-full bg-gold-400 hover:bg-gold-500 text-black font-bold py-3 rounded-xl mt-4 transition-all transform active:scale-95 flex justify-center items-center gap-2 shadow-[0_0_15px_rgba(212,175,55,0.3)]">
                    <span>Envoyer la demande</span>
                    <i data-lucide="send" class="w-4 h-4"></i>
                </button>
                
                <p class="text-[10px] text-center text-gray-500 mt-2">
                    Réponse garantie sous 15 minutes. Paiement à la livraison.
                </p>
            </form>
        </div>
    </div>
</div>

<!-- Flatpickr JS -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
    // --- DONNÉES DES VOITURES ---
    const cars = [
        { 
            id: 1, 
            name: "BMW Série 2", 
            model: "Coupé Sport (2015)", 
            price: 95,
            image: "bmw.png", 
            seats: 5, 
            transmission: "Auto",
            reservations: [],
            chevaux: 231,
            carburant: "Essence"
        },
        { 
            id: 2, 
            name: "Renault Captur", 
            model: "Urbain SUV (2020)", 
            price: 40,
            image: "renault-captur-gris-cassiopee.jpg", 
            seats: 5, 
            transmission: "Manuelle",
            reservations: [],
            chevaux: 115,
            carburant: "Diesel"
        },
        { 
            id: 3, 
            name: "Audi A3 TFSI", 
            model: "Berline Compacte (2019)", 
            price: 80,
            image: "Audi.png",
            seats: 5, 
            transmission: "Auto",
            reservations: [],
            chevaux: 150,
            carburant: "Essence"
        }
    ];

    // --- GÉNÉRATION DE LA GRILLE ---
    const grid = document.getElementById('cars-grid');
    
    cars.forEach(car => {
        const card = document.createElement('div');
        card.className = "group relative overflow-hidden bg-[#111] border border-white/5 rounded-2xl transition-all duration-500 hover:border-gold-400/50 hover:-translate-y-2";
        
        let buttonHTML = `<button onclick="openModal(${car.id})" class="w-full bg-white text-black hover:bg-gold-400 font-bold py-3 rounded-xl transition-all duration-300">Réserver ce véhicule</button>`;
        let priceDisplay = `<p class="text-2xl font-bold text-gold-400">${car.price}€</p>`;
        
        card.innerHTML = `
            <div class="relative h-56 overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-t from-[#111] to-transparent z-10 opacity-60"></div>
                <img src="${car.image}" alt="${car.name}" class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-110">
            </div>
            <div class="p-6 relative z-20 -mt-8">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h4 class="text-xl font-bold text-white group-hover:text-gold-400 transition-colors">${car.name}</h4>
                        <p class="text-sm text-gray-500">${car.model}</p>
                    </div>
                    <div class="text-right">
                        ${priceDisplay}
                        <p class="text-[10px] text-gray-500 uppercase tracking-wide">/ jour</p>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-6">
                    <div class="flex flex-col items-center justify-center py-2 text-xs text-gray-400 border border-white/10 rounded-lg bg-black/30">
                        <i data-lucide="users" class="w-4 h-4 text-gold-400 mb-1"></i>
                        <span class="font-bold text-white">${car.seats}</span>
                        <span class="text-[10px] text-gray-500">PLACES</span>
                    </div>
                    <div class="flex flex-col items-center justify-center py-2 text-xs text-gray-400 border border-white/10 rounded-lg bg-black/30">
                        <i data-lucide="zap" class="w-4 h-4 text-gold-400 mb-1"></i>
                        <span class="font-bold text-white">${car.transmission}</span>
                        <span class="text-[10px] text-gray-500">TRANSMISSION</span>
                    </div>
                    <div class="flex flex-col items-center justify-center py-2 text-xs text-gray-400 border border-white/10 rounded-lg bg-black/30">
                        <i data-lucide="gauge" class="w-4 h-4 text-gold-400 mb-1"></i>
                        <span class="font-bold text-white">${car.chevaux} Ch</span>
                        <span class="text-[10px] text-gray-500">PUISSANCE</span>
                    </div>
                    <div class="flex flex-col items-center justify-center py-2 text-xs text-gray-400 border border-white/10 rounded-lg bg-black/30">
                        <i data-lucide="fuel" class="w-4 h-4 text-gold-400 mb-1"></i>
                        <span class="font-bold text-white">${car.carburant}</span>
                        <span class="text-[10px] text-gray-500">CARBURANT</span>
                    </div>
                </div>
                ${buttonHTML}
            </div>
        `;
        grid.appendChild(card);
    });

    function scrollToCars() {
        document.getElementById('cars-section').scrollIntoView({ behavior: 'smooth' });
    }

    const modal = document.getElementById('booking-modal');
    let currentCar = null;

    function openModal(carId) {
        currentCar = cars.find(c => c.id === carId);
        if(!currentCar) return;

        document.getElementById('modal-car-name').innerText = currentCar.name;
        document.getElementById('modal-car-price').innerText = currentCar.price + "€ / jour";
        document.getElementById('modal-car-img').src = currentCar.image;

        modal.classList.remove('hidden');

        // --- Flatpickr ---
        flatpickr("#booking-dates", {
            mode: "range",
            minDate: "today",
            dateFormat: "Y-m-d",
            disable: currentCar.reservations.map(r => ({ from: r.from, to: r.to }))
        });
    }

    function closeModal() {
        modal.classList.add('hidden');
    }

    document.addEventListener('keydown', e => {
        if (e.key === "Escape") closeModal();
    });

    function submitBooking(e) {
        e.preventDefault();

        const btn = e.target.querySelector('button[type="submit"]');
        const originalContent = btn.innerHTML;

        const carPrice = Number(document.getElementById('modal-car-price').innerText.replace('€ / jour',''));
        const dateRange = document.getElementById('booking-dates').value.split(' to ');
        const startDate = new Date(dateRange[0]);
        const endDate = new Date(dateRange[1]);
        const oneDay = 24 * 60 * 60 * 1000;
        const totalDays = Math.round((endDate - startDate)/oneDay) + 1;
        const totalPrice = totalDays * carPrice;

        const params = {
            car_name: currentCar.name,
            car_price: carPrice,
            start_date: dateRange[0],
            end_date: dateRange[1],
            total_days: totalDays,
            total_price: totalPrice,
            user_name: document.getElementById('booking-name').value,
            user_phone: document.getElementById('booking-phone').value,
        };

        btn.disabled = true;
        btn.innerHTML = `<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i> Envoi en cours...`;
        lucide.createIcons();

        const serviceID = "service_dz89nq9"; 
        const templateID = "template_q4473i7";

        emailjs.send(serviceID, templateID, params)
        .then(() => {
            btn.innerHTML = `<i data-lucide="check" class="w-4 h-4"></i> Demande reçue !`;
            btn.classList.remove('bg-gold-400', 'text-black', 'hover:bg-gold-500');
            btn.classList.add('bg-green-600', 'text-white');
            lucide.createIcons();

            setTimeout(() => {
                closeModal();
                setTimeout(() => {
                    e.target.reset(); 
                    btn.disabled = false;
                    btn.innerHTML = originalContent;
                    btn.classList.add('bg-gold-400', 'text-black', 'hover:bg-gold-500');
                    btn.classList.remove('bg-green-600', 'text-white');
                    lucide.createIcons();
                }, 500);
            }, 2000);

        }, (err) => {
            console.error("Erreur EmailJS:", err);
            btn.innerHTML = "Erreur, réessayez.";
            btn.classList.add('bg-red-500', 'text-white');
            
            setTimeout(() => {
                btn.disabled = false;
                btn.innerHTML = originalContent;
                btn.classList.remove('bg-red-500', 'text-white');
                lucide.createIcons();
            }, 3000);
        });
    }

    lucide.createIcons();
</script>

</body>
</html>

